{"version":3,"sources":["../src/FormControl.jsx"],"names":["ORIGINAL_VALUES","Symbol","ORIGINAL_CLASS_NAMES","GET_RESULT_FROM_SCHEMA","ASSEMBLE_FIELD_FROM_RESULT","ASSEMBLE_FIELD_CHANGE","ASYNC_ASSEMBLE_FIELD_CHANGE","ASSEMBLE_FIELD_VALIDATE","ASYNC_ASSEMBLE_FIELD_VALIDATE","schemas","methods","props","values","classNames","state","fields","initClassNames","init","validator","Object","assign","formControl","nextProps","keys","name","theValue","value","String","className","static","setState","forEach","every","result","Component","propTypes","object","childContextTypes","isRequired","classes","undefined","createDelayValidateFunc","ms","debounceValidateAndUpdate","forceUpdate","delayFunc","schema","validateField","error","classNameArray","success","filter","item","join","message","resultField","validateFieldsByNames","names","isValid","onFormChange","e","target","type","slice","index","indexOf","push","splice","formDidChange","changeValues","addSchemas","removeSchemas","length","validateByNames","addValues","removeValues","resetValues","validate"],"mappings":"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","file":"FormControl.js","sourcesContent":["/**\n * A lightweight and extensible React validation component\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Validator from 'validate-framework-utils';\nimport debounce from 'lodash.debounce';\nimport isNumber from 'lodash.isnumber';\n\nconst ORIGINAL_VALUES = Symbol('#ORIGINAL_VALUES');\nconst ORIGINAL_CLASS_NAMES = Symbol('#ORIGINAL_CLASS_NAMES');\n\nconst GET_RESULT_FROM_SCHEMA = Symbol('#GET_RESULT_FROM_SCHEMA');\nconst ASSEMBLE_FIELD_FROM_RESULT = Symbol('#ASSEMBLE_FIELD_FROM_RESULT');\n\nconst ASSEMBLE_FIELD_CHANGE = Symbol('#ASSEMBLE_FIELD_CHANGE');\nconst ASYNC_ASSEMBLE_FIELD_CHANGE = Symbol('#ASYNC_ASSEMBLE_FIELD_CHANGE');\n\nconst ASSEMBLE_FIELD_VALIDATE = Symbol('#ASSEMBLE_FIELD_VALIDATE');\nconst ASYNC_ASSEMBLE_FIELD_VALIDATE = Symbol('#ASYNC_ASSEMBLE_FIELD_VALIDATE');\n\n/**\n * React validation component\n * @param schemas\n * @param methods Extended Validation Method\n */\nexport default (schemas, methods) => FormComponent => (\n\n  /**\n   * Returns a react form\n   */\n  class FormControl extends React.Component {\n\n    static propTypes = {\n      values: PropTypes.object,\n      classNames: PropTypes.object,\n    };\n\n    static childContextTypes = {\n      formControl: PropTypes.object.isRequired,\n    };\n\n    schemas = { ...schemas };\n\n    [ORIGINAL_VALUES] = {};\n\n    [ORIGINAL_CLASS_NAMES] = {};\n\n    constructor(props) {\n      super(props);\n      const {\n        values,\n        classNames,\n      } = props;\n\n      this.state = {\n        fields: {},\n      };\n\n      if (classNames) {\n        this.initClassNames(classNames);\n      }\n      if (values) {\n        this.init(values);\n      }\n\n      // Initializes the validation component and customizes the validation method\n      this.validator = new Validator();\n      Object.assign(this.validator, methods, { fields: this.state.fields });\n    }\n\n    getChildContext() {\n      return {\n        formControl: this,\n      };\n    }\n\n    componentWillReceiveProps(nextProps) {\n      const { values } = nextProps;\n      // No value\n      if (!values) {\n        return;\n      }\n      // Updates the state from the parent component\n      const { fields } = this.state;\n\n      (async () => {\n        // eslint-disable-next-line no-restricted-syntax\n        for (const name of Object.keys(values)) {\n          const theValue = values[name];\n          // Convert to string\n          const value = isNumber(theValue) ? String(theValue) : theValue;\n          // Validate the new data\n          if (fields[name]) {\n            // diff\n            if (fields[name].value !== value) {\n              await this[ASYNC_ASSEMBLE_FIELD_CHANGE](name, value);\n            }\n          } else {\n            // Add a new field\n            fields[name] = {\n              className: this[ORIGINAL_CLASS_NAMES].static,\n              value,\n            };\n          }\n        }\n        // Update\n        this.setState({\n          fields,\n        });\n      })();\n    }\n\n    /**\n     * Get the fields object\n     * @returns {Object}\n     */\n    get fields() {\n      return this.state.fields;\n    }\n\n    /**\n     * Gets a list of form values\n     * @return {Object}\n     */\n    get formValues() {\n      const { fields } = this.state;\n      const values = {};\n      Object.keys(fields).forEach((name) => {\n        values[name] = fields[name].value;\n      });\n      return values;\n    }\n\n    /**\n     * Gets the global validation status\n     * @return {Boolean}\n     */\n    get isAllValid() {\n      const { fields } = this.state;\n      return Object\n        .keys(this.schemas)\n        .every(name => fields[name] && fields[name].result);\n    }\n\n    /**\n     * Initializes the form value and classes\n     * @param values\n     * @param classes\n     */\n    init = (values, classes) => {\n      const { fields } = this.state;\n      // Assign classNames\n      if (classes) {\n        this.initClassNames(classes);\n      }\n      // Initialize\n      Object.keys(values).forEach((name) => {\n        const theValue = values[name];\n        // Convert to string\n        const value = isNumber(theValue) ? String(theValue) : theValue;\n        fields[name] = {\n          ...fields[name],\n          className: this[ORIGINAL_CLASS_NAMES].static,\n          value,\n        };\n        // Only initialized once\n        if (this[ORIGINAL_VALUES][name] === undefined) {\n          this[ORIGINAL_VALUES][name] = value;\n        }\n        // Synchronize values external state\n        if (this.props.values) {\n          this.props.values[name] = value;\n        }\n      });\n      return this;\n    };\n\n    /**\n     * Init classNames\n     * @param classes\n     */\n    initClassNames = (classes) => {\n      // Merge\n      Object.assign(this[ORIGINAL_CLASS_NAMES], classes);\n      return this;\n    };\n\n    /**\n     * Create asynchronous validation\n     * See createField.jsx\n     * @param ms\n     * @return {Function}\n     */\n    createDelayValidateFunc = (ms) => {\n      const debounceValidateAndUpdate = async (...args) => {\n        await this[ASYNC_ASSEMBLE_FIELD_VALIDATE](...args);\n        this.forceUpdate();\n      };\n      return debounce(debounceValidateAndUpdate, ms);\n    };\n\n    [ASSEMBLE_FIELD_CHANGE] = (name, value) => {\n      const { fields } = this.state;\n      fields[name].value = value;\n      // Async\n      if (fields[name].delayFunc) {\n        fields[name].delayFunc(name, value);\n      } else {\n        this[ASSEMBLE_FIELD_VALIDATE](name, value);\n      }\n    };\n\n    [ASYNC_ASSEMBLE_FIELD_CHANGE] = async (name, value) => {\n      this.state.fields[name].value = value;\n      await this[ASYNC_ASSEMBLE_FIELD_VALIDATE](name, value);\n    };\n\n    [GET_RESULT_FROM_SCHEMA] = (name, value) => {\n      const schema = this.schemas[name];\n      return schema ? this.validator.validateField({ ...schema, name })(value) : {};\n    };\n\n    [ASSEMBLE_FIELD_FROM_RESULT] = (name, { result, error }) => {\n      const classNames = this[ORIGINAL_CLASS_NAMES];\n      const { fields } = this.state;\n\n      const classNameArray = [\n        classNames.static,\n        result ? classNames.success : null,\n        result === false ? classNames.error : null,\n      ];\n      // Assemble\n      Object.assign(fields[name], {\n        className: classNameArray.filter(item => item).join('\\u{20}'),\n        result,\n        message: error ? error.message : undefined,\n      });\n    };\n\n    [ASSEMBLE_FIELD_VALIDATE] = (name, value) => {\n      const resultField = this[GET_RESULT_FROM_SCHEMA](name, value);\n      this[ASSEMBLE_FIELD_FROM_RESULT](name, resultField);\n    };\n\n    [ASYNC_ASSEMBLE_FIELD_VALIDATE] = async (name, value) => {\n      const resultField = await this[GET_RESULT_FROM_SCHEMA](name, value);\n      this[ASSEMBLE_FIELD_FROM_RESULT](name, resultField);\n    };\n\n    /**\n     * Validate fields by names\n     * @param names\n     * @return {Boolean}\n     */\n    validateFieldsByNames = async (...names) => {\n      const { fields } = this.state;\n      let isValid = true;\n      // eslint-disable-next-line no-restricted-syntax\n      for (const name of names) {\n        if (fields[name]) {\n          await this[ASYNC_ASSEMBLE_FIELD_VALIDATE](name, fields[name].value);\n\n          // Exclude unauthenticated and validated successfully\n          if (fields[name].result === false) {\n            isValid = false;\n          }\n        }\n      }\n      return isValid;\n    };\n\n    // Form change event listener\n    onFormChange = (e) => {\n      const { name, type, value } = e.target;\n      const { fields } = this.state;\n\n      // Dependent on the name attribute\n      if (!name) {\n        return;\n      }\n\n      let theValue;\n      // Checkbox processing\n      if (type === 'checkbox') {\n        theValue = fields[name].value.slice();\n        const index = theValue.indexOf(value);\n        if (index === -1) {\n          theValue.push(value);\n        } else {\n          theValue.splice(index, 1);\n        }\n      } else {\n        theValue = value;\n      }\n      // Synchronize values external state\n      if (this.props.values) {\n        this.props.values[name] = theValue;\n      }\n      // Assemble and delay validate\n      this[ASSEMBLE_FIELD_CHANGE](name, theValue);\n      // Update\n      this.setState({\n        fields,\n      });\n      this.formDidChange({ [name]: theValue });\n    };\n\n    /**\n     * Customize to change the values\n     * @param values\n     */\n    changeValues = (values) => {\n      const { fields } = this.state;\n      // Initializes\n      this.init(values);\n      Object.keys(values).forEach((name) => {\n        this[ASSEMBLE_FIELD_CHANGE](name, values[name]);\n      });\n      // Update\n      this.setState({\n        fields,\n      });\n      this.formDidChange(values);\n      return this;\n    };\n\n    /**\n     * Add one or more validation rules\n     * @param schema\n     */\n    addSchemas = (schema) => {\n      Object.assign(this.schemas, schema);\n      return this;\n    };\n\n    /**\n     * Delete one or more validation rules\n     * If there is no name, it will all be removed.\n     * @param names\n     */\n    removeSchemas = (...names) => {\n      if (names.length) {\n        names.forEach((name) => {\n          delete this.schemas[name];\n        });\n      } else {\n        this.schemas = {};\n      }\n      // Validate the deleted status\n      this.validateByNames(...names);\n      return this;\n    };\n\n    /**\n     * Add one or more fields\n     * @param values\n     */\n    addValues = (values) => {\n      const { fields } = this.state;\n      // Initializes\n      this.init(values);\n      // Update\n      this.setState({\n        fields,\n      });\n      this.formDidChange(values);\n      return this;\n    };\n\n    /**\n     * Deletes one or more fields\n     * If there is no name, it will all be removed.\n     * @param names\n     */\n    removeValues = (...names) => {\n      const { fields } = this.state;\n      if (names.length) {\n        names.forEach((name) => {\n          delete fields[name];\n          if (this.props.values) {\n            delete this.props.values[name];\n          }\n        });\n      } else {\n        // Remove all\n        Object.keys(fields).forEach((name) => {\n          delete this.state.fields[name];\n          if (this.props.values) {\n            delete this.props.values[name];\n          }\n        });\n      }\n      // Update\n      this.setState({\n        fields,\n      });\n      this.formDidChange({});\n      return this;\n    };\n\n    /**\n     * Reset one or more fields\n     * If there is no name, it will all be init.\n     * @param names\n     */\n    resetValues = (...names) => {\n      const { fields } = this.state;\n      const values = {};\n      if (names.length) {\n        names.forEach((name) => {\n          values[name] = this[ORIGINAL_VALUES][name];\n        });\n        this.init(values);\n      } else {\n        // Init all\n        Object.assign(values, this[ORIGINAL_VALUES]);\n        this.init(values);\n      }\n      // Update\n      this.setState({\n        fields,\n      });\n      this.formDidChange(values);\n      return this;\n    };\n\n    /**\n     * Validate the component through names\n     * @param names\n     * @return {Boolean}\n     */\n    validateByNames = async (...names) => {\n      const result = await this.validateFieldsByNames(...names);\n      const { fields } = this.state;\n      // Update\n      this.setState({\n        fields,\n      });\n      return result;\n    };\n\n    /**\n     * Validate all\n     * @return {Boolean}\n     */\n    validate = () => this.validateByNames(...Object.keys(this.schemas));\n\n    // After change\n    formDidChange = () => {};\n\n    render() {\n      return (\n        <FormComponent\n          {...this.props}\n          formControl={this}\n        />\n      );\n    }\n  }\n);\n"]}